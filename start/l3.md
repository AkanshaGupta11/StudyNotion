class 2 

revise 

STUDENT 
login 
signup 
otp -> verify email 
reset pass -> email ->link -> change new pass 


INSTRUCTOR 
login/signup 
otp->verify email 

home page 
course -> pyhton k filter -> filtering 
title desc , content , wht will u learn section subsec 

wishlist 

student dashboard 
profile 
edit details 
enrolled courses 

instructor dash 
inst specific course 
course create 



-------------------------------------------------------------------
controller 
login , signup , send otp 

CONTROLLER -> AUTH -> send otp , signu p , login , change pass 
            -> reset pass -> generate a llink  and send mail -> vho link mai jaakr pass ko reset kr skte  -> resetPassToken 

Middlewares -> auth 
            ->issTudent , isInstructor, isAdmin 



SEND OTP -> PHELE SIGNUP K FLOW SE SMHTE 
email ko fetch kiya 
user -> not exist --> return response 
user exist --> generate otp --> make sure it is unique 
otp -> store in DB inorder to match it when the user enter 

otp mai expires likha hain tho agr expers in 5min likha hain tho automatically 5min baad deleted ho jaayega 

POINTTTTTTTTTTTTTTT
yha bekaar cheej ky kr rhe

->OTP GENERATE KR RHE 
->PHIR CHECK KR RHE 
->JB TK DUPLICATE OTP MILL RHA NEW GENERATE KR RHE 
--. yha baar baar db mai entyr check krni pd rhi hain 

- INSTEADDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD
EK AISI LIBRARY USE KRO JHO GUARANTEED UNIQQUE OTP DE 

FLOW OF OTP GENERATION 
1> FETCH EMAIL FROM REQ BODY 
2> CHECK IF EMAIL ALREADY EXIST 
3>IF USER EXIST --> RETURN RESPONSE 
4> USER NOT EXIST -> GENERATE OTP 
5> HOW WILL GENERATE OTP --> otp-generator
6>CHECK KI DUPLICATE OTP THO NI 
7> JB TK DUPLICATE OTP MIL RHA WILL GENERATE NEW ONE 
8>OTP MILL GYA 
9> MAKE ENTRY IN DB 
10>RETURN RESPONSE 
DB CALL MAI LOOP CHAALNA --> BHT GNDAA Code --> find some package 
OR BHI VALIDATION ADD KR SKTE HO ISMAI -> LIKE EMAIL VALIDATION KI KHI GLT EMAIL THO NHI AA GYI 


//SIGN UP 
hoskta aapki id mai multiple otp generated ho --. pick the recent one 
signup mai confirm ass, contact num likha lekin model mai bhool gye 
FLOWWWW-->
1> data fetch -> fname , lname , email , pass , confmpass 
2>validate kiya --> if any of these not present return res 
3> if(pass and confmpass dont match ) -> return res
4>if(user already exist ) -> return res 

5> otp fetch recent waaal 
await otp.fid({emial}).sort({createdAt:-1}.limit(1))

6> validate otp -> otp.length != 0 
--> otp or recent otp match kr rhe ki nhi 

7> encrypt pass -> using bcrypt 
8> entry in db 
9> return res 

DICEBEAR --> JAIS EHI NAAM INSET KROGE IMAGE create ho jaaye gi like --> akansha gupta -> AG k naam se create ho jaayegi 

signup screen se otp screen mai gye 
otp screen mai jaane se phele MAIL chla gya hoga 
otp.create se phle eotp send ho jaayega PRE MIDDLEWARE SE 


LOGIN FLOW -------------------------------------------->
1> fetch details email , password from reg body 
2> validation if every field there or not 
3> chk user exist 
if(user not exist ) -> return response

4> user exist 
Password matching 
if(await bcrytp.compare(password, user.password)){
    if password match tho token bhejoge 
    token = jwt.sign(payload, secret,{
        expireIn
    })

    usertoken = token
    user.pass = undef

    cookie save kroge 
}


FORGET PASSWORD 
->link generate hota for creating new pass -> will send in mail ->
-> mail pai send krene ->1
-> link click -> ui open -> enter new password ->2

token generation --> crypto ->

agr every user has a toke  and expiry => will become very esy for mapping 
user mai sdd kiya 


FORGET PASSWORD 
> email fetch from req body 
>chk user exist 
>hrr user -> k liye diff link -> diff token 

for creating token --> crypto 
every user -> token and xpiration time -> mapping krne tho easy ho jaayega 
model -> user 
token-> string 
expirationtime -> date 

generate token 
update user by adding token and expiration
--> user k andr token add kiya or expiry time 
create url 
send mail containing url
return response


fetch email chk 
user exist 
token bnaya -> cryptUUID 
url bnaya 
send krna -> mailsender 
return res 



RESET PASSWORD 
link mai click kr k -> page jha new password daal re / password update kr rhe 

1> token ayega , pass,confirmpass
2>validation 
token k use kr k user nikal o jha pass update krna 
3>if no etry for otken -> return 
4> hash 

